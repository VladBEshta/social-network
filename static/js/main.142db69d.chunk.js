(this["webpackJsonpfisrt-react-app"]=this["webpackJsonpfisrt-react-app"]||[]).push([[0],{130:function(e,t,n){},234:function(e,t,n){"use strict";n.r(t);var s=n(0),r=n.n(s),i=n(23),a=n(14),c=n(2),o=n(100),u=n.n(o).a.create({withCredentials:!0,baseURL:"https://social-network.samuraijs.com/api/1.0/",headers:{"API-KEY":"460e160f-8602-44bf-be3b-c0e6c732b3ac"}}),l={posts:[{id:1,post:"HII",likes:25},{id:2,post:"Byyy",likes:0}],profile:null,status:"My status from global state"},j=function(e){return{type:"SET-USER-STATUS",status:e}},b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD-POST":return Object(c.a)(Object(c.a)({},e),{},{posts:[].concat(Object(a.a)(e.posts),[{id:3,post:t.newPostText,likes:0}])});case"SET-USER-PROFILE":return Object(c.a)(Object(c.a)({},e),{},{profile:t.profile});case"SET-USER-STATUS":return Object(c.a)(Object(c.a)({},e),{},{status:t.status});default:return e}},d={dialogs:[{id:1,name:"Vladek"},{id:2,name:"Vadik"},{id:3,name:"Madik"}],messages:[{id:1,message:"hi"},{id:2,message:"bi"}]},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SEND-MESSAGE":return Object(c.a)(Object(c.a)({},e),{},{messages:[].concat(Object(a.a)(e.messages),[{id:5,message:t.newMessage}])});default:return e}},g={users:[],totalCount:10,currentPage:1,pageSize:5,isFetching:!1,inProgress:[]},h=function(e){return{type:"TOGGLE-FETCHING",isFetching:e}},f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TOGGLE-FOLLOW":return Object(c.a)(Object(c.a)({},e),{},{users:e.users.map((function(e){return e.id===t.userId?Object(c.a)(Object(c.a)({},e),{},{followed:!e.followed}):e}))});case"SET-USERS":return Object(c.a)(Object(c.a)({},e),{},{users:t.users});case"CHANGE-CURRENT-PAGE":return Object(c.a)(Object(c.a)({},e),{},{currentPage:t.currentPage});case"SET-TOTAL-PAGES":return Object(c.a)(Object(c.a)({},e),{},{totalCount:t.totalCount});case"TOGGLE-FETCHING":return Object(c.a)(Object(c.a)({},e),{},{isFetching:t.isFetching});case"TOGGLE-IN-PROGRESS":return Object(c.a)(Object(c.a)({},e),{},{inProgress:t.isFetching?[].concat(Object(a.a)(e.inProgress),[t.userId]):e.inProgress.filter((function(e){return e!==t.userId}))});default:return e}},O={id:null,login:null,email:null,isAuth:!1},m=function(){return function(e){return u.get("auth/me").then((function(e){return e.data})).then((function(t){if(0===t.resultCode){var n=t.data,s=n.id,r=n.login,i=n.email;e(x(s,r,i,!0))}}))}},x=function(e,t,n,s){return{type:"SET-AUTH-DATA",data:{id:e,login:t,email:n,isAuth:s}}},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET-AUTH-DATA":return Object(c.a)(Object(c.a)({},e),t.data);default:return e}},P=n(101),S={initialized:!1},C=function(){return{type:"SET-INITIALIZE"}},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET-INITIALIZE":return Object(c.a)(Object(c.a)({},e),{},{initialized:!0});default:return e}},E=Object(i.b)({profilePage:b,dialogPage:p,usersPage:f,auth:v,app:T}),w=Object(i.d)(E,Object(i.a)(P.a));window.store=w;var y=w,A=n(48),N=n.n(A),k=(n(130),n(3)),I=n(4),_=n(7),F=n(8),L=(n(33),n(1)),U=function(){return Object(L.jsx)("div",{className:"footer"})},z=n(13),G=function(){return Object(L.jsxs)("div",{className:"nav",children:[Object(L.jsx)(z.b,{to:"/profile",activeClassName:"activeNav",children:"Profile"}),Object(L.jsx)(z.b,{to:"/dialogs",activeClassName:"activeNav",children:"Dialogs"}),Object(L.jsx)(z.b,{to:"/news",activeClassName:"activeNav",children:"News"}),Object(L.jsx)(z.b,{to:"/users",activeClassName:"activeNav",children:"Users"}),Object(L.jsx)(z.b,{to:"/music",activeClassName:"activeNav",children:"Music"}),Object(L.jsx)(z.b,{to:"/settings",activeClassName:"activeNav",children:"Settings"})]})},M=n(9),R=function(e){return Object(L.jsx)("div",{children:Object(L.jsx)("div",{children:e.name})})},D=function(e){return Object(L.jsx)("div",{children:e.message})},H=n(30),V=n(12),q=n(21),Z=function(e){return Object(L.jsx)("div",{children:e.children})},B=["label","name"],J=function(e){var t=e.label,n=e.name,s=Object(q.a)(e,B);return Object(L.jsxs)("div",{children:[Object(L.jsx)("label",{htmlFor:n,children:t}),Object(L.jsx)(V.b,Object(c.a)({id:n,name:n},s)),Object(L.jsx)(V.a,{name:n,component:Z})]})},X=["label","name"],W=function(e){var t=e.label,n=e.name,s=Object(q.a)(e,X);return Object(L.jsxs)("div",{children:[Object(L.jsx)("label",{htmlFor:n,children:t}),Object(L.jsx)(V.b,Object(c.a)({as:"textarea",type:n,id:n,name:n},s)),Object(L.jsx)(V.a,{name:n,component:Z})]})},K=["label","name"],Q=function(e){var t=e.label,n=e.name,s=Object(q.a)(e,K);return Object(L.jsxs)("div",{children:[Object(L.jsx)("label",{htmlFor:n,children:t}),Object(L.jsx)(V.b,Object(c.a)({type:n,id:n,name:n},s)),Object(L.jsx)(V.a,{name:n,component:Z})]})},Y=["control"],$=function(e){var t=e.control,n=Object(q.a)(e,Y);switch(t){case"input":return Object(L.jsx)(J,Object(c.a)({},n));case"textarea":return Object(L.jsx)(W,Object(c.a)({},n));case"checkbox":return Object(L.jsx)(Q,Object(c.a)({},n));default:return null}},ee=function(e){var t=H.a({}),n=e.dialogs.map((function(e){return Object(L.jsx)(R,{name:e.name,id:e.id})})),s=e.messages.map((function(e){return Object(L.jsx)(D,{id:e.id,message:e.message})}));return Object(L.jsxs)("div",{className:"dialogs",children:[Object(L.jsx)("div",{className:"dialogItems",children:n}),Object(L.jsxs)("div",{className:"message",children:[Object(L.jsx)("div",{children:s}),Object(L.jsx)("div",{children:Object(L.jsx)(V.d,{initialValues:{newMessage:""},validationSchema:t,onSubmit:function(t,n){e.sendMessageAction(t.newMessage),n.resetForm()},children:function(e){return Object(L.jsxs)(V.c,{children:[Object(L.jsx)($,{control:"textarea",name:"newMessage"}),Object(L.jsx)("button",{type:"submit",children:"Send message"})]})}})})]})]})},te=n(11),ne=function(e){return{isAuth:e.auth.isAuth}},se=function(e){var t=function(t){Object(_.a)(s,t);var n=Object(F.a)(s);function s(){return Object(k.a)(this,s),n.apply(this,arguments)}return Object(I.a)(s,[{key:"render",value:function(){return this.props.isAuth?Object(L.jsx)(e,Object(c.a)({},this.props)):Object(L.jsx)(M.a,{to:"/login"})}}]),s}(r.a.Component);return Object(te.b)(ne)(t)},re=Object(i.c)(Object(te.b)((function(e){return{messages:e.dialogPage.messages,newMessageText:e.dialogPage.newMessageText,dialogs:e.dialogPage.dialogs}}),(function(e){return{sendMessageAction:function(t){e(function(e){return{type:"SEND-MESSAGE",newMessage:e}}(t))}}})),se)(ee),ie=n(37),ae=n.n(ie),ce=n.p+"static/media/userPhoto.22c31152.png",oe=n(50),ue=n(22),le=n(107),je=n.n(le),be=function(e){for(var t=e.totalItemsCount,n=e.pageSize,r=e.currentPage,i=e.onPageChange,a=e.portionSize,c=void 0===a?10:a,o=Math.ceil(t/n),u=[],l=1;l<=o;l++)u.push(l);var j=Math.ceil(o/c),b=Object(s.useState)(1),d=Object(ue.a)(b,2),p=d[0],g=d[1],h=(p-1)*c+1,f=p*c;return Object(L.jsxs)("div",{className:ae.a.paginator,children:[p>1&&Object(L.jsx)("button",{onClick:function(){g(p-1)},children:"PREV"}),u.filter((function(e){return e>=h&&e<=f})).map((function(e){return Object(L.jsx)("span",{className:je()(Object(oe.a)({},ae.a.selectedPage,r===e),ae.a.pageNumber),onClick:function(t){return i(e)},children:e},e)})),j>p&&Object(L.jsx)("button",{onClick:function(){g(p+1)},children:"NEXT"})]})},de=["currentPage","onPageChange","pageSize","totalItemsCount"],pe=function(e){var t=e.currentPage,n=e.onPageChange,s=e.pageSize,r=e.totalItemsCount,i=Object(q.a)(e,de);return Object(L.jsxs)("div",{children:[Object(L.jsx)(be,{currentPage:t,onPageChange:n,pageSize:s,totalItemsCount:r}),i.users.map((function(e){return Object(L.jsxs)("div",{children:[Object(L.jsxs)("div",{children:["name:",e.name," userId:",e.id," "]},e.id),Object(L.jsx)("div",{children:Object(L.jsx)(z.b,{to:"/profile/"+e.id,children:Object(L.jsx)("img",{className:ae.a.imgSize,src:null!=e.photos.small?e.photos.small:ce,alt:""})})}),Object(L.jsx)("button",{disabled:i.inProgress.some((function(t){return t===e.id})),onClick:function(){var t,n;i.toggleProgress(!0,e.id),e.followed?(n=e.id,u.delete("follow/".concat(n)).then((function(e){return e.data}))).then((function(t){0===t.resultCode&&(i.follow(e.id),i.toggleProgress(!1,e.id))})):(t=e.id,u.post("follow/".concat(t)).then((function(e){return e.data}))).then((function(t){0===t.resultCode&&(i.follow(e.id),i.toggleProgress(!1,e.id))}))},children:e.followed?"unfollow":"follow"})]})}))]})},ge=function(e){Object(_.a)(n,e);var t=Object(F.a)(n);function n(){var e;Object(k.a)(this,n);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).onCurrentChange=function(t){e.props.getUsersThunk(t,e.props.pageSize)},e}return Object(I.a)(n,[{key:"componentDidMount",value:function(){this.props.getUsersThunk(this.props.currentPage,this.props.pageSize)}},{key:"render",value:function(){return Object(L.jsxs)("div",{children:[this.props.isFetching?Object(L.jsx)("span",{children:"Is loading...."}):void 0,Object(L.jsx)(pe,{totalItemsCount:this.props.totalCount,pageSize:this.props.pageSize,currentPage:this.props.currentPage,follow:this.props.toggleFollow,users:this.props.users,onPageChange:this.onCurrentChange,isFetching:this.isFetching,inProgress:this.props.inProgress,toggleProgress:this.props.toggleProgress})]})}}]),n}(r.a.Component),he=Object(i.c)(Object(te.b)((function(e){return{users:e.usersPage.users,totalCount:e.usersPage.totalCount,pageSize:e.usersPage.pageSize,currentPage:e.usersPage.currentPage,isFetching:e.usersPage.isFetching,inProgress:e.usersPage.inProgress,toggleProgress:e.usersPage.toggleProgress}}),{toggleFollow:function(e){return{type:"TOGGLE-FOLLOW",userId:e}},toggleFetching:h,toggleProgress:function(e,t){return{type:"TOGGLE-IN-PROGRESS",isFetching:e,userId:t}},getUsersThunk:function(e,t){return function(n){n(h(!0)),n(function(e){return{type:"CHANGE-CURRENT-PAGE",currentPage:e}}(e)),function(e,t){return u.get("users?page=".concat(e,"&count=").concat(t)).then((function(e){return e.data}))}(e,t).then((function(e){n({type:"SET-USERS",users:e.items}),n({type:"SET-TOTAL-PAGES",totalCount:e.totalCount}),n(h(!1))}))}}}),se)(ge),fe=function(e){var t=H.a({});return Object(L.jsx)(V.d,{initialValues:{newPostText:""},onSubmit:function(t,n){console.log(t),e.addPostAction(t.newPostText),n.resetForm()},validationSchema:t,children:function(e){return Object(L.jsxs)(V.c,{children:[Object(L.jsx)($,{control:"textarea",name:"newPostText"}),Object(L.jsx)("button",{type:"submit",children:"Create post"})]})}})},Oe=Object(te.b)((function(e){return{newPost:e.profilePage.newPost}}),(function(e){return{addPostAction:function(t){e(function(e){return{type:"ADD-POST",newPostText:e}}(t))}}}))(fe),me=function(e){return Object(L.jsxs)("div",{children:[" ",e.post.map((function(e){return Object(L.jsxs)("div",{children:["Body: ",e.post," Likes: ",e.likes]})}))]})},xe=Object(te.b)((function(e){return{post:e.profilePage.posts}}),(function(){return{}}))(me),ve=function(e){return e.profile?Object(L.jsxs)("div",{children:[Object(L.jsx)("span",{children:Object(L.jsx)("img",{alt:"profileAva",src:null!=e.profile.photos.small?e.profile.photos.small:ce})}),Object(L.jsxs)("div",{children:["name: ",e.profile.fullName]})]}):Object(L.jsx)("div",{children:"isLoading..."})},Pe=n(69),Se=n.n(Pe),Ce=function(e){var t=Object(s.useState)(!1),n=Object(ue.a)(t,2),r=n[0],i=n[1],a=Object(s.useState)(e.status),c=Object(ue.a)(a,2),o=c[0],u=c[1];Object(s.useEffect)((function(){u(e.status)}),[e.status]);var l=function(){i(!r),o&&e.updateStatus(o)};return r?Object(L.jsx)("input",{autoFocus:!0,onBlur:l,className:Se.a.statusContainer,value:o,onChange:function(e){u(e.currentTarget.value)},type:"text"}):Object(L.jsx)("div",{className:Se.a.statusContainer,onDoubleClick:l,children:o||"Status is empty"})},Te=function(e){return Object(L.jsxs)("div",{className:"profile",children:[Object(L.jsx)(ve,{profile:e.profile}),Object(L.jsx)(Ce,{status:e.status,updateStatus:e.updateStatus}),Object(L.jsx)(Oe,{store:e.store}),Object(L.jsx)(xe,{store:e.store})]})},Ee=function(e){Object(_.a)(n,e);var t=Object(F.a)(n);function n(){return Object(k.a)(this,n),t.apply(this,arguments)}return Object(I.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.match.params.userId;void 0===e&&(e=this.props.loggedUserId),this.props.getProfileDataThunk(e),this.props.getProfileStatusThunk(e)}},{key:"render",value:function(){return Object(L.jsx)(Te,Object(c.a)(Object(c.a)({},this.props),{},{profile:this.props.profile,status:this.props.status,updateStatus:this.props.updateStatus}))}}]),n}(r.a.Component),we=Object(i.c)(Object(te.b)((function(e){return{state:e,profile:e.profilePage.profile,status:e.profilePage.status,loggedUserId:e.auth.id}}),{getProfileDataThunk:function(e){return function(t){(function(e){return u.get("profile/"+e).then((function(e){return e.data}))})(e).then((function(e){return t({type:"SET-USER-PROFILE",profile:e})}))}},getProfileStatusThunk:function(e){return function(t){(function(e){return u.get("profile/status/".concat(e)).then((function(e){return e.data}))})(e).then((function(e){return t(j(e))}))}},updateStatus:function(e){return function(t){(function(e){return u.put("profile/status",{status:e}).then((function(e){return e.data}))})(e).then((function(n){0===n.result\u0421ode&&t(j(e))}))}}}),M.f,se)(Ee),ye=function(e){return Object(L.jsx)("div",{className:"header",children:Object(L.jsx)("div",{className:"login",children:e.isAuth?Object(L.jsxs)("div",{children:[e.login," - ",Object(L.jsx)("button",{onClick:e.logoutTC,children:"Logout"})]}):Object(L.jsx)(z.b,{to:"/login",children:"Login"})})})},Ae=function(e){Object(_.a)(n,e);var t=Object(F.a)(n);function n(){return Object(k.a)(this,n),t.apply(this,arguments)}return Object(I.a)(n,[{key:"render",value:function(){return Object(L.jsx)(ye,Object(c.a)({},this.props))}}]),n}(r.a.Component),Ne=Object(te.b)((function(e){return{login:e.auth.login,isAuth:e.auth.isAuth}}),{logoutTC:function(){return function(e){u.delete("auth/login").then((function(e){return e.data})).then((function(t){0===t.resultCode&&e(x(null,null,null,!1))}))}}})(Object(M.f)(Ae)),ke=Object(te.b)((function(e){return{isAuth:e.auth.isAuth,serverError:e.auth.serverError}}),{loginTC:function(e,t,n){return function(s){(function(e,t,n){return u.post("auth/login",{email:e,password:t,rememberMe:n}).then((function(e){return e.data}))})(e,t,n).then((function(e){0===e.resultCode?(console.log(e),s(m())):alert(e.messages[0])}))}}})((function(e){var t=H.a({email:H.b().required("Required").email("Incorrect email format"),password:H.b().required("Required")});return e.isAuth?Object(L.jsx)(M.a,{to:"/profile"}):Object(L.jsxs)("div",{children:[Object(L.jsx)("h1",{children:"Login"}),Object(L.jsx)(V.d,{initialValues:{email:"",password:"",rememberMe:!1},validationSchema:t,onSubmit:function(t){e.loginTC(t.email,t.password,t.rememberMe)},children:function(e){return Object(L.jsxs)(V.c,{children:[Object(L.jsx)($,{control:"input",type:"name",label:"Email",name:"email"}),Object(L.jsx)($,{control:"input",type:"password",label:"Password",name:"password"}),Object(L.jsx)($,{control:"checkbox",type:"checkbox",label:"Remember me",name:"rememberMe"}),Object(L.jsx)("button",{type:"submit",children:"Login"})]})}})]})})),Ie=function(e){Object(_.a)(n,e);var t=Object(F.a)(n);function n(){return Object(k.a)(this,n),t.apply(this,arguments)}return Object(I.a)(n,[{key:"componentDidMount",value:function(){this.props.initializeApp()}},{key:"render",value:function(){return this.props.initialized?Object(L.jsx)(z.a,{children:Object(L.jsxs)("div",{className:"wrapper",children:[Object(L.jsx)(Ne,{}),Object(L.jsx)(G,{}),Object(L.jsx)(M.b,{path:"/profile/:userId?",render:function(){return Object(L.jsx)(we,{})}}),Object(L.jsx)(M.b,{path:"/dialogs",render:function(){return Object(L.jsx)(re,{})}}),Object(L.jsx)(M.b,{path:"/users",render:function(){return Object(L.jsx)(he,{})}}),Object(L.jsx)(M.b,{path:"/login",render:function(){return Object(L.jsx)(ke,{})}}),Object(L.jsx)(U,{})]})}):"...loading"}}]),n}(r.a.Component),_e=Object(te.b)((function(e){return{initialized:e.app.initialized}}),{initializeApp:function(){return function(e){var t=e(m());Promise.all([t]).then((function(){e(C())}))}}})(Ie);N.a.render(Object(L.jsx)(te.a,{store:y,children:Object(L.jsx)(_e,{})}),document.getElementById("root"))},33:function(e,t,n){},37:function(e,t,n){e.exports={selected:"Users_selected__3EqQf",isFetching:"Users_isFetching__18CSe",pageLinks:"Users_pageLinks__ZfMAT",imgSize:"Users_imgSize__1PRvR",paginator:"Users_paginator__2icJZ",pageNumber:"Users_pageNumber__1LdiP",selectedPage:"Users_selectedPage__1aaL5"}},69:function(e,t,n){e.exports={selected:"Profile_selected__39ExA",isFetching:"Profile_isFetching__XiAok",pageLinks:"Profile_pageLinks__2mem9",imgSize:"Profile_imgSize__2XOIU",statusContainer:"Profile_statusContainer__2oZeI"}}},[[234,1,2]]]);
//# sourceMappingURL=main.142db69d.chunk.js.map